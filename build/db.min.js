/*!
(C) Andrea Giammarchi, @WebReflection - Mit Style License
*/
var Database=(function(n,F){if(n[F]&&!n.opera){return n[F]}function v(K){if(!(this instanceof v)){return new v(K)}var J=this;K||(K={});e(J,i,{enumerable:!1,writable:!0,configurable:!0,value:j(J.name=K.name||y.domain.replace(/\./g,"_")||"db",J.version=K.version||"1.0",J.description=K.description||"data",J.size=K.size||I,q)});J[i][i]=J;return J}function u(){}function t(K,J,L){J[0]||(J[0]=r);this.query("CREATE"+p+l+" NOT"+A+K+" ("+J.join(", ")+")",L);return this}function B(K){K+="ransaction";return function J(O,L,N){var M=this;if(typeof L=="function"){N=L;L=[]}M[i][K](function(S){for(var V=x(O),P=H(L),R=0,T=E(V.length,P.length),U=(S[i]={self:M,fn:N,i:T}),Q;R<T;++R){S.executeSql(V[R]||V[0],P[R],k,C)}});return M}}function m(J,K){this.query(z+p+l+A+J,K);return this}function C(K,J){if(K=K[i]){--K.i||(K.fn||q)({type:"error",error:J,db:K.self})}}function a(J,P,N){for(var Q=this,R=[],O=H(P),M=0,L=O.length,K=w(O[0].length+1).join(", ?").slice(2);M<L;++M){R[M]="INSERT INTO "+J+" VALUES ("+K+")"}Q.query(R,O,N);return Q}function k(K,J){if(K=K[i]){--K.i||(K.fn||q)({type:"success",result:J,item:c,length:J.rows.length,db:K.self})}}function b(K,L){var J=this,N,M;J.query("SELECT * FROM sqlite_master WHERE name = ?",x(K),function(O){if(O.type=="success"){M=O.length&&O.result.rows.item(0);if(M&&M.type=="table"&&(M.tbl_name||M.name)==K){return J.query(z+p+K,function(P){J.query(M.sql,L)})}O.type="error";O.error={message:"table "+K+" does not exists"};delete O.result}L(O)});return J}function x(J){return g.call([],J===h?[]:J)}function q(){}function c(J){return this.result.rows.item(J)}function H(J){return !s(J)||typeof J[0]!="object"||!J[0]?[J]:J}var h,I=5*1024*1024,p=" TABLE ",z="DROP",A=" EXISTS ",l="IF",r="id INTEGER PRIMARY KEY AUTOINCREMENT",w=n.Array,o=n.Math,E=o.max,g=[].concat,D=B("readT"),f=B("t"),y=n.document,j=n.openDatabase,i="_"+(""+o.random()).slice(2),s=w.isArray||function(L,K){K=L.call([]);return function J(M){return K==L.call(M)}}({}.toString),G=n.Object,e=G.defineProperty||function(L,J,K){L[J]=K.value;return L},d=v.prototype;d.close=u;d.create=t;d.drop=m;d.insert=a;d.read=D;d.query=f;d.truncate=b;return v}(this,"Database"));